% Eric Pearson
close all;
clear;
clc;

%%
% Q5

rad_pow_boc = [ 0, 0, 0, 0, 0.2929, 0.3214, 0.2869, 0.2509, 0.2509, 0.2869, 0.3214, 0.2929, 0, 0, 0, 0; 
0, 0, 0.2176, 0.5286, 0.9362, 0.8532, 0.9445, 0.6035, 0.6035, 0.9445, 0.8532, 0.9362, 0.5286, 0.2176, 0, 0; 
0, 0.2176, 0.4507, 1.1064, 1.2854, 1.5250, 1.2274, 1.0027, 1.0027, 1.2274, 1.5250, 1.2854, 1.1064, 0.4507, 0.2176, 0; 
0, 0.5286, 1.1064, 1.0928, 1.7036, 1.2865, 1.6026, 1.0429, 1.0429, 1.6026, 1.2865, 1.7036, 1.0928, 1.1064, 0.5286, 0; 
0.2929, 0.9362, 1.2854, 1.7036, 1.5135, 1.7733, 1.4132, 1.1839, 1.1839, 1.4132, 1.7733, 1.5135, 1.7036, 1.2854, 0.9362, 0.2929; 
0.3214, 0.8532, 1.5250, 1.2865, 1.7733, 1.1513, 1.4096, 1.0659, 1.0659, 1.4096, 1.1513, 1.7733, 1.2865, 1.5250, 0.8532, 0.3214; 
0.2869, 0.9445, 1.2274, 1.6026, 1.4132, 1.4096, 0.7176, 0.6297, 0.6297, 0.7176, 1.4096, 1.4132, 1.6026, 1.2274, 0.9445, 0.2869; 
0.2509, 0.6035, 1.0027, 1.0429, 1.1839, 1.0659, 0.6297, 0.4633, 0.4633, 0.6297, 1.0659, 1.1839, 1.0429, 1.0027, 0.6035, 0.2509; 
0.2509, 0.6035, 1.0027, 1.0429, 1.1839, 1.0659, 0.6297, 0.4633, 0.4633, 0.6297, 1.0659, 1.1839, 1.0429, 1.0027, 0.6035, 0.2509; 
0.2869, 0.9445, 1.2274, 1.6026, 1.4132, 1.4096, 0.7176, 0.6297, 0.6297, 0.7176, 1.4096, 1.4132, 1.6026, 1.2274, 0.9445, 0.2869; 
0.3214, 0.8532, 1.5250, 1.2865, 1.7733, 1.1513, 1.4096, 1.0659, 1.0659, 1.4096, 1.1513, 1.7733, 1.2865, 1.5250, 0.8532, 0.3214; 
0.2929, 0.9362, 1.2854, 1.7036, 1.5135, 1.7733, 1.4132, 1.1839, 1.1839, 1.4132, 1.7733, 1.5135, 1.7036, 1.2854, 0.9362, 0.2929; 
0, 0.5286, 1.1064, 1.0928, 1.7036, 1.2865, 1.6026, 1.0429, 1.0429, 1.6026, 1.2865, 1.7036, 1.0928, 1.1064, 0.5286, 0; 
0, 0.2176, 0.4507, 1.1064, 1.2854, 1.5250, 1.2274, 1.0027, 1.0027, 1.2274, 1.5250, 1.2854, 1.1064, 0.4507, 0.2176, 0; 
0, 0, 0.2176, 0.5286, 0.9362, 0.8532, 0.9445, 0.6035, 0.6035, 0.9445, 0.8532, 0.9362, 0.5286, 0.2176, 0, 0; 
0, 0, 0, 0, 0.2929, 0.3214, 0.2869, 0.2509, 0.2509, 0.2869, 0.3214, 0.2929, 0, 0, 0, 0]; 

rad_pow_mid = [ 0, 0, 0, 0, 0.3674, 0.4055, 0.3679, 0.3301, 0.3301, 0.3679, 0.4055, 0.3674, 0, 0, 0, 0; 
0, 0, 0.2779, 0.6131, 1.0285, 0.9295, 1.0522, 0.7040, 0.7040, 1.0522, 0.9295, 1.0285, 0.6131, 0.2779, 0, 0; 
0, 0.2779, 0.5284, 1.1612, 1.2606, 1.4743, 1.2228, 1.0482, 1.0482, 1.2228, 1.4743, 1.2606, 1.1612, 0.5284, 0.2779, 0; 
0, 0.6131, 1.1612, 1.0739, 1.5520, 1.1968, 1.4937, 1.0314, 1.0314, 1.4937, 1.1968, 1.5520, 1.0739, 1.1612, 0.6131, 0; 
0.3674, 1.0285, 1.2606, 1.5520, 1.3442, 1.5715, 1.3049, 1.1484, 1.1484, 1.3049, 1.5715, 1.3442, 1.5520, 1.2606, 1.0285, 0.3674; 
0.4055, 0.9295, 1.4743, 1.1968, 1.5715, 1.0834, 1.3558, 1.0677, 1.0677, 1.3558, 1.0834, 1.5715, 1.1968, 1.4743, 0.9295, 0.4055; 
0.3679, 1.0522, 1.2228, 1.4937, 1.3049, 1.3558, 0.7697, 0.7092, 0.7092, 0.7697, 1.3558, 1.3049, 1.4937, 1.2228, 1.0522, 0.3679; 
0.3301, 0.7040, 1.0482, 1.0314, 1.1484, 1.0677, 0.7092, 0.5607, 0.5607, 0.7092, 1.0677, 1.1484, 1.0314, 1.0482, 0.7040, 0.3301; 
0.3301, 0.7040, 1.0482, 1.0314, 1.1484, 1.0677, 0.7092, 0.5607, 0.5607, 0.7092, 1.0677, 1.1484, 1.0314, 1.0482, 0.7040, 0.3301; 
0.3679, 1.0522, 1.2228, 1.4937, 1.3049, 1.3558, 0.7697, 0.7092, 0.7092, 0.7697, 1.3558, 1.3049, 1.4937, 1.2228, 1.0522, 0.3679; 
0.4055, 0.9295, 1.4743, 1.1968, 1.5715, 1.0834, 1.3558, 1.0677, 1.0677, 1.3558, 1.0834, 1.5715, 1.1968, 1.4743, 0.9295, 0.4055; 
0.3674, 1.0285, 1.2606, 1.5520, 1.3442, 1.5715, 1.3049, 1.1484, 1.1484, 1.3049, 1.5715, 1.3442, 1.5520, 1.2606, 1.0285, 0.3674; 
0, 0.6131, 1.1612, 1.0739, 1.5520, 1.1968, 1.4937, 1.0314, 1.0314, 1.4937, 1.1968, 1.5520, 1.0739, 1.1612, 0.6131, 0; 
0, 0.2779, 0.5284, 1.1612, 1.2606, 1.4743, 1.2228, 1.0482, 1.0482, 1.2228, 1.4743, 1.2606, 1.1612, 0.5284, 0.2779, 0; 
0, 0, 0.2779, 0.6131, 1.0285, 0.9295, 1.0522, 0.7040, 0.7040, 1.0522, 0.9295, 1.0285, 0.6131, 0.2779, 0, 0; 
0, 0, 0, 0, 0.3674, 0.4055, 0.3679, 0.3301, 0.3301, 0.3679, 0.4055, 0.3674, 0, 0, 0, 0]; 

rad_pow_eoc = [ 0, 0, 0, 0, 0.4318, 0.4774, 0.4394, 0.4033, 0.4033, 0.4394, 0.4774, 0.4318, 0, 0, 0, 0; 
0, 0, 0.3358, 0.6748, 1.0628, 0.9691, 1.1003, 0.7765, 0.7765, 1.1003, 0.9691, 1.0628, 0.6748, 0.3358, 0, 0; 
0, 0.3358, 0.5903, 1.1685, 1.2246, 1.4060, 1.2051, 1.0724, 1.0724, 1.2051, 1.4060, 1.2246, 1.1685, 0.5903, 0.3358, 0; 
0, 0.6748, 1.1685, 1.0579, 1.4396, 1.1446, 1.4090, 1.0303, 1.0303, 1.4090, 1.1446, 1.4396, 1.0579, 1.1685, 0.6748, 0; 
0.4318, 1.0628, 1.2246, 1.4396, 1.2519, 1.4472, 1.2456, 1.1345, 1.1345, 1.2456, 1.4472, 1.2519, 1.4396, 1.2246, 1.0628, 0.4318; 
0.4774, 0.9691, 1.4060, 1.1446, 1.4472, 1.0586, 1.3205, 1.0834, 1.0834, 1.3205, 1.0586, 1.4472, 1.1446, 1.4060, 0.9691, 0.4774; 
0.4394, 1.1003, 1.2051, 1.4090, 1.2456, 1.3205, 0.8288, 0.7919, 0.7919, 0.8288, 1.3205, 1.2456, 1.4090, 1.2051, 1.1003, 0.4394; 
0.4033, 0.7765, 1.0724, 1.0303, 1.1345, 1.0834, 0.7919, 0.6634, 0.6634, 0.7919, 1.0834, 1.1345, 1.0303, 1.0724, 0.7765, 0.4033; 
0.4033, 0.7765, 1.0724, 1.0303, 1.1345, 1.0834, 0.7919, 0.6634, 0.6634, 0.7919, 1.0834, 1.1345, 1.0303, 1.0724, 0.7765, 0.4033; 
0.4394, 1.1003, 1.2051, 1.4090, 1.2456, 1.3205, 0.8288, 0.7919, 0.7919, 0.8288, 1.3205, 1.2456, 1.4090, 1.2051, 1.1003, 0.4394; 
0.4774, 0.9691, 1.4060, 1.1446, 1.4472, 1.0586, 1.3205, 1.0834, 1.0834, 1.3205, 1.0586, 1.4472, 1.1446, 1.4060, 0.9691, 0.4774; 
0.4318, 1.0628, 1.2246, 1.4396, 1.2519, 1.4472, 1.2456, 1.1345, 1.1345, 1.2456, 1.4472, 1.2519, 1.4396, 1.2246, 1.0628, 0.4318; 
0, 0.6748, 1.1685, 1.0579, 1.4396, 1.1446, 1.4090, 1.0303, 1.0303, 1.4090, 1.1446, 1.4396, 1.0579, 1.1685, 0.6748, 0; 
0, 0.3358, 0.5903, 1.1685, 1.2246, 1.4060, 1.2051, 1.0724, 1.0724, 1.2051, 1.4060, 1.2246, 1.1685, 0.5903, 0.3358, 0; 
0, 0, 0.3358, 0.6748, 1.0628, 0.9691, 1.1003, 0.7765, 0.7765, 1.1003, 0.9691, 1.0628, 0.6748, 0.3358, 0, 0; 
0, 0, 0, 0, 0.4318, 0.4774, 0.4394, 0.4033, 0.4033, 0.4394, 0.4774, 0.4318, 0, 0, 0, 0]; 

ax_pow_boc = [ 0.0000, 0.4823, 0.7997, 1.0190, 1.1628, 1.2578, 1.3189, ...
               1.3544, 1.3693, 1.3669, 1.3498, 1.3201, 1.2799, 1.2308, ...
               1.1745, 1.1124, 1.0456, 0.9750, 0.9014, 0.8248, 0.7444, ...
               0.6576, 0.5583, 0.4330, 0.2613, 0.0000]; 

ax_pow_mid = [ 0.0000, 0.9021, 1.3625, 1.5722, 1.6205, 1.5873, 1.5158, ...
               1.4282, 1.3361, 1.2453, 1.1589, 1.0783, 1.0043, 0.9372, ...
               0.8770, 0.8238, 0.7775, 0.7378, 0.7042, 0.6755, 0.6491, ...
               0.6196, 0.5748, 0.4898, 0.3222, 0.0000]; 

ax_pow_eoc = [ 0.0000, 1.2408, 1.7392, 1.8989, 1.8719, 1.7693, 1.6408, ...
               1.5076, 1.3782, 1.2558, 1.1417, 1.0364, 0.9398, 0.8519, ...
               0.7727, 0.7021, 0.6399, 0.5861, 0.5409, 0.5040, 0.4747, ...
               0.4504, 0.4233, 0.3737, 0.2602, 0.0000]; 
           
figure(1);
b = bar3(rad_pow_boc);
h = colorbar;
set(get(h,'label'),'string','Normalized Assembly Power');
axis tight;
for k = 1:length(b)
    zdata = b(k).ZData;
    b(k).CData = zdata;
    b(k).FaceColor = 'flat';
end
title({'Fig. 1a: Normalized Assembly Power Distribution'; ...
       'BOC Hot Full Power'; 'k_{eff}=1.005792, boron=1250ppm'});
xlabel('x Coordinate');
ylabel('y Coordinate');
zlabel('Normalized Assembly Power');

figure(2);
plot((26:-1:1),ax_pow_boc,'-k');
xlabel('z coordinate');
ylabel('Normalized Axial Core Power');
title({'Fig. 1b: Normalized Axial Core Power Distribution';...
       'BOC Hot Full Power'});
   
figure(3);
b = bar3(rad_pow_mid);
h = colorbar;
set(get(h,'label'),'string','Normalized Assembly Power');
axis tight;
for k = 1:length(b)
    zdata = b(k).ZData;
    b(k).CData = zdata;
    b(k).FaceColor = 'flat';
end
title({'Fig. 2a: Normalized Assembly Power Distribution'; ...
       'Cycle 7 Hot Full Power'; 'k_{eff}=1.004025, boron=546.2ppm'});
xlabel('x Coordinate');
ylabel('y Coordinate');
zlabel('Normalized Assembly Power');

figure(4);
plot((26:-1:1),ax_pow_mid,'-k');
xlabel('z coordinate');
ylabel('Normalized Axial Core Power');
title({'Fig. 2b: Normalized Axial Core Power Distribution';...
       'Cycle 7 Hot Full Power'});
   
figure(5);
b = bar3(rad_pow_eoc);
h = colorbar;
set(get(h,'label'),'string','Normalized Assembly Power');
axis tight;
for k = 1:length(b)
    zdata = b(k).ZData;
    b(k).CData = zdata;
    b(k).FaceColor = 'flat';
end
title({'Fig. 3a: Normalized Assembly Power Distribution'; ...
       'EOC Hot Full Power'; 'k_{eff}=1.001121, boron=0.1ppm'});
xlabel('x Coordinate');
ylabel('y Coordinate');
zlabel('Normalized Assembly Power');

figure(5);
plot((26:-1:1),ax_pow_eoc,'-k');
xlabel('z coordinate');
ylabel('Normalized Axial Core Power');
title({'Fig. 3b: Normalized Axial Core Power Distribution';...
       'EOC Hot Full Power'});



